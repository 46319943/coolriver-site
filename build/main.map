{"version":3,"sources":["webpack:///webpack/bootstrap a25e1976a27aed346298","webpack:///external \"path\"","webpack:///./server/db/index.js","webpack:///external \"fs\"","webpack:///./server/models/index.js","webpack:///./server/db/libs/init.js","webpack:///external \"lowdb\"","webpack:///external \"lowdb/adapters/FileSync\"","webpack:///./server/models/article.js","webpack:///external \"shortid\"","webpack:///./server/server.js","webpack:///external \"koa\"","webpack:///external \"koa-sslify\"","webpack:///external \"http\"","webpack:///external \"https\"","webpack:///external \"nuxt\"","webpack:///./server/router/router.js","webpack:///external \"koa-router\"","webpack:///./server/controllers/article.js","webpack:///./node_modules/babel-runtime/regenerator/index.js","webpack:///external \"regenerator-runtime\"","webpack:///./server/libs/cors.js","webpack:///external \"koa2-cors\"","webpack:///./nuxt.config.js","webpack:///./server/syncArticleData.js","webpack:///external \"walk\"","webpack:///./server/libs/mdParser.js","webpack:///./server/entry.js"],"names":["low","require","FileSync","path","dbDataPath","resolve","__dirname","adapter","DB","defaults","posts","users","write","articleModel","get","insertOrUpdate","title","time","img","desc","tags","name","data","articleFind","find","value","push","Object","assign","id","shortid","generate","getList","filter","app","host","process","env","HOST","port","PORT","config","dev","console","log","use","enforceHttps","nuxt","builder","build","catch","error","e","exit","setupCors","setupRouter","ctx","status","Promise","reject","res","on","render","req","promise","then","http","createServer","callback","listen","https","key","fs","readFileSync","cert","router","routes","next","list","body","article","query","whiteDomain","cors","origin","hostname","indexOf","module","exports","head","meta","charset","content","hid","itemprop","link","rel","type","href","script","src","async","extend","imageLoaderConf","rules","item","test","toString","vueLoader","rule","loader","options","loaders","sass","concat","limit","css","plugins","ssr","vendor","mdDir","walkMd","walker","walk","root","fileStats","birthtime","fileNamePur","replace","filePath","readFile","err","parseTags","parseDesc","parseImage","parseTitle","TAG_REG","matches","match","tagsStr","split","DESC_REG","IMG_REG","TITLE_REG","trim","BACKPACK_ENTRY_MAP","server","runEntryCommand","BACKPACK_ENTRY","entry","task"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 26);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a25e1976a27aed346298","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 0\n// module chunks = 0 1 2","import DB from './libs/init';\n\nexport { DB };\n\n\n\n// WEBPACK FOOTER //\n// ./server/db/index.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 2\n// module chunks = 0 1 2","import  * as articleModel from './article';\n\nexport { articleModel };\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/index.js","const low = require('lowdb');\r\nconst FileSync = require('lowdb/adapters/FileSync');\r\nconst path = require('path');\r\nconst dbDataPath = path.resolve(__dirname, '../data.json');\r\nconst adapter = new FileSync(dbDataPath);\r\nconst DB = low(adapter);\r\n\r\n// Set some defaults\r\nDB.defaults({ posts: [], users: [] })\r\n  .write();\r\n\r\nexport default DB;\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/db/libs/init.js","module.exports = require(\"lowdb\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lowdb\"\n// module id = 5\n// module chunks = 0 1 2","module.exports = require(\"lowdb/adapters/FileSync\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lowdb/adapters/FileSync\"\n// module id = 6\n// module chunks = 0 1 2","import { DB } from '../db/index';\nimport shortid from 'shortid';\n\nconst articleModel = DB.get('articles');\n\n// 添加或者更新（如果文章name已经存在的话）一个文章信息\nexport function insertOrUpdate({ title, time, img, desc, tags, name }) {\n  const data = {\n    title,\n    img,\n    desc,\n    tags,\n    name\n  };\n  const articleFind = articleModel.find({ name });\n\n  if (!articleFind.value()) {\n    // 新增article时，需要传入id和创建时间\n    articleModel.push(Object.assign({}, data, {\n      id: shortid.generate(),\n      time: +time,\n    })).write();\n  } else {\n    articleFind.assign(data).write();\n  }\n};\n\n// 根据条件返回文章列表\nexport function getList (filter = {}) {\n  return articleModel.filter(filter).value();\n};\n\n// 根据条件返回一个文章信息\nexport function find (filter = {}) {\n  return articleModel.find(filter).value();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/article.js","module.exports = require(\"shortid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"shortid\"\n// module id = 8\n// module chunks = 0 1 2","\nimport Koa from 'koa';\nimport enforceHttps from'koa-sslify';\nimport http from 'http';\nimport https from 'https';\nimport path from 'path';\nimport fs from 'fs';\nimport { Nuxt, Builder } from 'nuxt';\nimport { DB } from './db/index';\nimport setupRouter from './router/router';\nimport setupCors from './libs/cors';\n\nconst app = new Koa();\nconst host = process.env.HOST || '127.0.0.1';\nconst port = process.env.PORT || 80;\n\n// Import and Set Nuxt.js options\nlet config = require('../nuxt.config.js');\nconfig.dev = !(app.env === 'production');\n\n// 正式环境下启用https\nif (!config.dev) {\n  console.log('enable https');\n  app.use(enforceHttps());\n}\n\n// Instantiate nuxt.js\nconst nuxt = new Nuxt(config);\n\n// Build in development\nif (config.dev) {\n  const builder = new Builder(nuxt);\n  builder.build().catch(e => {\n    console.error(e); // eslint-disable-line no-console\n    process.exit(1);\n  });\n}\n\nsetupCors(app);\nsetupRouter(app);\n\napp.use(ctx => {\n  ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n\n  return new Promise((resolve, reject) => {\n    ctx.res.on('close', resolve)\n    ctx.res.on('finish', resolve)\n    nuxt.render(ctx.req, ctx.res, promise => {\n      // nuxt.render passes a rejected promise into callback on error.\n      promise.then(resolve).catch(reject)\n    })\n  })\n})\n\n// app.listen(port, '0.0.0.0');\nhttp.createServer(app.callback()).listen(port);\n\nif (!config.dev) {\n  https.createServer({\n    key: fs.readFileSync(path.resolve(__dirname, './ssl/2_coolriver.net.cn.key')),\n    cert: fs.readFileSync(path.resolve(__dirname, './ssl/1_coolriver.net.cn_bundle.crt')),\n  }, app.callback()).listen(443);\n}\n\nconsole.log('Server listening on a ' + host + ':' + port); // eslint-disable-line no-console\n\n\n\n// WEBPACK FOOTER //\n// ./server/server.js","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 10\n// module chunks = 0 1","module.exports = require(\"koa-sslify\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-sslify\"\n// module id = 11\n// module chunks = 0 1","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 12\n// module chunks = 0 1","module.exports = require(\"https\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"https\"\n// module id = 13\n// module chunks = 0 1","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 14\n// module chunks = 0 1","import Router from 'koa-router';\nimport * as article from '../controllers/article';\n\nconst router = new Router();\n\nexport default function setupRouter (app) {\n  router.get('/api/articles', article.getList);\n  router.get('/api/article', article.find);\n\n  app.use(router.routes());\n};\n\n\n\n// WEBPACK FOOTER //\n// ./server/router/router.js","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 16\n// module chunks = 0 1","import { articleModel } from '../models/index';\n\nexport async function getList(ctx, next) {\n    const list = articleModel.getList();\n    ctx.status = 200;\n    ctx.body = list;\n    // next();\n}\n\nexport async function find (ctx, next) {\n  const article = articleModel.find({ name: ctx.query.name });\n  ctx.status = 200;\n  ctx.body = article;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/article.js","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/regenerator/index.js\n// module id = 18\n// module chunks = 0 1","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 19\n// module chunks = 0 1","import cors from 'koa2-cors';\n\nconst whiteDomain = [\n  'coolriver.net.cn',\n  'localhost',\n  '127.0.0.1',\n];\n\nexport default function setupCors (app) {\n  app.use(cors({\n    origin: (ctx) => {\n      // return '*';\n      console.log(ctx.hostname);\n      if (whiteDomain.indexOf(ctx.hostname) >= 0) {\n        return ctx.origin;\n      }\n\n      return false;\n    },\n  }));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/libs/cors.js","module.exports = require(\"koa2-cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa2-cors\"\n// module id = 21\n// module chunks = 0 1","module.exports = {\n  head: {\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { hid: 'description', name: 'description', content: 'coolriver的个人博客站点' },\n      { hid: 'keywords', name: 'keywords', content: 'coolriver,前端,博客' },\n      { hid: 'shareimg', itemprop: 'image', content: 'https://coolriver.net.cn/avatar.jpg' },\n    ],\n    link: [\n      {\n        rel: 'icon',\n        type: 'image/x-icon',\n        href: '/favicon.ico',\n      },\n    ],\n    script: [\n      {\n        src: 'https://hm.baidu.com/hm.js?406ea27bfbb3000b689c8ab5f17ebb86',\n        async: 'async'\n      }\n    ],\n    title: 'coolriver的空间',\n  },\n  build: {\n    extend: function (config) {\n      const imageLoaderConf = config.module.rules.find(function (item) {\n        return item.test.toString().indexOf('|svg') >= 0;\n      });\n\n      const vueLoader = config.module.rules.find((rule) => rule.loader === 'vue-loader');\n      vueLoader.options.loaders.sass = 'vue-style-loader!css-loader!sass-loader';\n\n      imageLoaderConf.test = /\\.(png|jpe?g|gif)$/;\n\n      config.module.rules = config.module.rules.concat([\n        {\n          test: /\\.md$/,\n          loaders: ['raw-loader', 'markdown-code-highlight-loader']\n        },\n        {\n          test: /\\.svg$/,\n          loader: 'svg-url-loader',\n          options: {\n            limit: 1000\n          }\n        }\n      ]);\n    }\n  },\n  css: [\n    'vuetify/dist/vuetify.css',\n    '~assets/css/common.css',\n    'mdi/css/materialdesignicons.css',\n    'highlight.js/styles/atom-one-dark.css',\n    'github-markdown-css/github-markdown.css'\n  ],\n  plugins: [\n    '~plugins/vue-vuetify',\n    {\n      src: '~plugins/busuanzi',\n      ssr: false\n    },\n    '~plugins/filter',\n  ],\n  vendor: ['axios']\n};\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","import path from 'path';\nimport walk from 'walk';\nimport fs from 'fs';\nimport { articleModel } from './models/index';\nimport { parseTags, parseDesc, parseImage, parseTitle } from './libs/mdParser';\n\nconst mdDir = path.resolve(__dirname, '../markdown/');\n\n// articleModel.addOrUpdateArticle('test');\n\nfunction walkMd() {\n  const walker = walk.walk(mdDir, {\n\n  });\n\n  walker.on('file', function(root, fileStats, next) {\n    const { name, birthtime } = fileStats;\n    const fileNamePur = name.replace(/\\.md$/, '');\n    const filePath = path.resolve(mdDir, name);\n\n    fs.readFile(filePath, 'utf8', (err, data) => {\n      const tags = parseTags(data);\n      const desc = parseDesc(data);\n      const img = parseImage(data);\n      const title = parseTitle(data);\n\n      articleModel.insertOrUpdate({\n        title,\n        img,\n        desc,\n        tags,\n        name: fileNamePur,\n        time: birthtime,\n      });\n\n      next();\n    });\n  });\n}\n\nwalkMd();\n\nconsole.log('sync article done');\n\n\n\n// WEBPACK FOOTER //\n// ./server/syncArticleData.js","module.exports = require(\"walk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"walk\"\n// module id = 24\n// module chunks = 0 2","/**\n * 解析md文档中的tag占位符，得到文章的tags\n * @export\n * @param {String} content md内容文本\n * @returns {Array} tags列表\n */\nexport function parseTags (content) {\n  const TAG_REG = /^<!--TAG\\s*(.*)\\s*\\/TAG-->$/m;\n  const matches = content.match(TAG_REG) || [];\n  const tagsStr = matches[1];\n\n  return tagsStr ? tagsStr.split(';') : [];\n};\n\n/**\n * 解析md文档中的描述点位符，得到文章的简介信息\n *\n * @export\n * @param {String} content md内容文本\n * @returns {String} 文章简介\n */\nexport function parseDesc (content) {\n  //const DESC_REG = /^<!--DESC\\s*(.*)\\s*\\/DESC-->$/m;\n  const DESC_REG = /^(?=[\\u4e00-\\u9fa5]|[\\w])(.*)$/m;\n  const matches = content.match(DESC_REG) || [];\n\n  return matches[1] || '暂无简介信息';\n};\n\n/**\n * 解析文档中的图片信息，得到第一张图片链接\n *\n * @export\n * @param {String} content md内容文本\n * @returns {String} 图片链接\n */\nexport function parseImage (content) {\n  const IMG_REG = /!\\[\\]\\(([^\\(\\)]+)\\)/;\n  const matches = content.match(IMG_REG) || [];\n\n  return matches[1] || '/image/default-article-img.jpg';\n};\n\n/**\n * 解析文档中的标题信息\n *\n * @export\n * @param {String} content md内容文本\n * @returns {String} 文章标题\n */\nexport function parseTitle (content) {\n  const TITLE_REG = /^#(.+)$/m;\n  const matches = content.match(TITLE_REG) || [];\n  const title = matches[1] && matches[1].trim() || '未知标题';\n\n  console.log('title: ' + title);\n  return title;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/libs/mdParser.js","\nconst BACKPACK_ENTRY_MAP = {\n  server: () => {\n    require('./server');\n  },\n  'sync-article': () => {\n    require('./syncArticleData');\n  }\n};\n\nconst runEntryCommand = () => {\n  console.log(process.env.BACKPACK_ENTRY);\n  const entry = process.env.BACKPACK_ENTRY;\n  const task = BACKPACK_ENTRY_MAP[entry] || BACKPACK_ENTRY_MAP['server'];\n\n  task();\n}\n\nrunEntryCommand();\n\n\n\n// WEBPACK FOOTER //\n// ./server/entry.js"],"sourceRoot":""}