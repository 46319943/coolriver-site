{"version":3,"sources":["webpack:///webpack/bootstrap 9453d9fff4fa5cd5cb38","webpack:///./server/db/index.js","webpack:///external \"path\"","webpack:///./server/models/index.js","webpack:///./server/db/libs/init.js","webpack:///external \"lowdb\"","webpack:///external \"lowdb/adapters/FileSync\"","webpack:///./server/models/article.js","webpack:///external \"shortid\"","webpack:///./server/server.js","webpack:///external \"koa\"","webpack:///external \"nuxt\"","webpack:///./server/router/router.js","webpack:///external \"koa-router\"","webpack:///./server/controllers/article.js","webpack:///./node_modules/babel-runtime/regenerator/index.js","webpack:///external \"regenerator-runtime\"","webpack:///./server/libs/cors.js","webpack:///external \"koa2-cors\"","webpack:///./nuxt.config.js","webpack:///./server/syncArticleData.js","webpack:///external \"walk\"","webpack:///external \"fs\"","webpack:///./server/libs/mdParser.js","webpack:///./server/entry.js"],"names":["low","require","FileSync","path","dbDataPath","resolve","__dirname","adapter","DB","defaults","posts","users","write","articleModel","get","insertOrUpdate","title","time","img","desc","tags","name","data","articleFind","find","push","Object","assign","id","shortid","generate","getList","filter","value","app","host","process","env","HOST","port","PORT","config","dev","nuxt","builder","build","catch","console","error","e","exit","setupCors","setupRouter","use","ctx","status","Promise","reject","res","on","render","req","promise","then","listen","log","router","routes","next","list","body","whiteDomain","cors","origin","hostname","indexOf","module","exports","head","meta","charset","content","hid","extend","rules","concat","test","loaders","loader","query","limit","css","plugins","vendor","mdDir","walkMd","walker","walk","root","fileStats","birthtime","fileNamePur","replace","filePath","fs","readFile","err","parseTags","parseDesc","parseImage","parseTitle","item","TAG_REG","matches","match","tagsStr","split","DESC_REG","IMG_REG","TITLE_REG","trim","BACKPACK_ENTRY_MAP","server","runEntryCommand","BACKPACK_ENTRY","entry","task"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 23);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9453d9fff4fa5cd5cb38","import DB from './libs/init';\n\nexport { DB };\n\n\n\n// WEBPACK FOOTER //\n// ./server/db/index.js","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 1\n// module chunks = 0 1 2","import  * as articleModel from './article';\n\nexport { articleModel };\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/index.js","const low = require('lowdb');\r\nconst FileSync = require('lowdb/adapters/FileSync');\r\nconst path = require('path');\r\nconst dbDataPath = path.resolve(__dirname, '../data.json');\r\nconst adapter = new FileSync(dbDataPath);\r\nconst DB = low(adapter);\r\n\r\n// Set some defaults\r\nDB.defaults({ posts: [], users: [] })\r\n  .write();\r\n\r\nexport default DB;\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/db/libs/init.js","module.exports = require(\"lowdb\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lowdb\"\n// module id = 4\n// module chunks = 0 1 2","module.exports = require(\"lowdb/adapters/FileSync\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lowdb/adapters/FileSync\"\n// module id = 5\n// module chunks = 0 1 2","import { DB } from '../db/index';\nimport shortid from 'shortid';\n\nconst articleModel = DB.get('articles');\n\n// 添加或者更新（如果文章name已经存在的话）一个文章信息\nexport function insertOrUpdate({ title, time, img, desc, tags, name }) {\n  const data = {\n    title,\n    img,\n    desc,\n    tags,\n    name\n  };\n  const articleFind = find({ name });\n\n  if (!articleFind) {\n    // 新增article时，需要传入id和创建时间\n    articleModel.push(Object.assign({}, data, {\n      id: shortid.generate(),\n      time: +time,\n    })).write();\n  } else {\n    articleModel.assign(data).write();\n  }\n};\n\n// 根据条件返回文章列表\nexport function getList (filter = {}) {\n  return articleModel.filter(filter).value();\n};\n\n// 根据条件返回一个文章信息\nexport function find (filter = {}) {\n  return articleModel.find(filter).value();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/article.js","module.exports = require(\"shortid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"shortid\"\n// module id = 7\n// module chunks = 0 1 2","\nimport Koa from 'koa';\nimport { Nuxt, Builder } from 'nuxt';\nimport { DB } from './db/index';\nimport setupRouter from './router/router';\nimport setupCors from './libs/cors';\n\nconst app = new Koa();\nconst host = process.env.HOST || '127.0.0.1';\nconst port = process.env.PORT || 80;\n\n// Import and Set Nuxt.js options\nlet config = require('../nuxt.config.js');\nconfig.dev = !(app.env === 'production');\n\n// Instantiate nuxt.js\nconst nuxt = new Nuxt(config);\n\n// Build in development\nif (config.dev) {\n  const builder = new Builder(nuxt);\n  builder.build().catch(e => {\n    console.error(e); // eslint-disable-line no-console\n    process.exit(1);\n  });\n}\n\nsetupCors(app);\nsetupRouter(app);\n\napp.use(ctx => {\n  ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n\n  return new Promise((resolve, reject) => {\n    ctx.res.on('close', resolve)\n    ctx.res.on('finish', resolve)\n    nuxt.render(ctx.req, ctx.res, promise => {\n      // nuxt.render passes a rejected promise into callback on error.\n      promise.then(resolve).catch(reject)\n    })\n  })\n})\n\napp.listen(port, '0.0.0.0');\nconsole.log('Server listening on a ' + host + ':' + port); // eslint-disable-line no-console\n\n\n\n// WEBPACK FOOTER //\n// ./server/server.js","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 9\n// module chunks = 0 1","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 10\n// module chunks = 0 1","import Router from 'koa-router';\nimport * as article from '../controllers/article';\n\nconst router = new Router();\n\nexport default function setupRouter (app) {\n  router.get('/api/article/list', article.getList);\n\n  app.use(router.routes());\n};\n\n\n\n// WEBPACK FOOTER //\n// ./server/router/router.js","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 12\n// module chunks = 0 1","import { articleModel } from '../models/index';\n\nexport async function getList(ctx, next) {\n    const list = articleModel.getList();\n    ctx.status = 200;\n    ctx.body = list;\n    // next();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/article.js","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/regenerator/index.js\n// module id = 14\n// module chunks = 0 1","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 15\n// module chunks = 0 1","import cors from 'koa2-cors';\n\nconst whiteDomain = [\n  'coolriver.net.cn',\n  'localhost',\n  '127.0.0.1',\n];\n\nexport default function setupCors (app) {\n  app.use(cors({\n    origin: (ctx) => {\n      // return '*';\n      console.log(ctx.hostname);\n      if (whiteDomain.indexOf(ctx.hostname) >= 0) {\n        return ctx.origin;\n      }\n\n      return false;\n    },\n  }));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/libs/cors.js","module.exports = require(\"koa2-cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa2-cors\"\n// module id = 17\n// module chunks = 0 1","module.exports = {\n  head: {\n    meta: [\n      { charset: \"utf-8\" },\n      { name: \"viewport\", content: \"width=device-width, initial-scale=1\" },\n      { hid: \"description\", name: \"description\", content: \"Meta description\" }\n    ]\n  },\n  build: {\n    extend: function(config) {\n      config.module.rules = config.module.rules.concat([\n        {\n          test: /\\.md$/,\n          loaders: [\"raw-loader\", \"markdown-code-highlight-loader\"]\n        },\n        {\n          test: /\\.(woff2?|eot|ttf|otf|svg)(\\?.*)?$/,\n          loader: \"url-loader\",\n          query: {\n            limit: 1000, // 1 KO\n            name: \"fonts/[name].[hash:7].[ext]\"\n          }\n        }\n      ]);\n    },\n    loaders: [\n      {\n        test: /\\.md$/,\n        loaders: [\"raw-loader\", \"markdown-code-highlight-loader\"]\n      },\n      {\n        test: /\\.(woff2?|eot|ttf|otf|svg)(\\?.*)?$/,\n        loader: \"url-loader\",\n        query: {\n          limit: 1000, // 1 KO\n          name: \"fonts/[name].[hash:7].[ext]\"\n        }\n      }\n    ]\n  },\n  css: [\n    \"vuetify/dist/vuetify.css\",\n    \"~assets/css/common.css\",\n    \"mdi/css/materialdesignicons.css\",\n    \"highlight.js/styles/atom-one-dark.css\",\n    \"github-markdown-css/github-markdown.css\"\n  ],\n  plugins: [\"~plugins/vue-vuetify\"],\n  vendor: ['axios']\n};\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","import path from 'path';\nimport walk from 'walk';\nimport fs from 'fs';\nimport { articleModel } from './models/index';\nimport { parseTags, parseDesc, parseImage, parseTitle } from './libs/mdParser';\n\nconst mdDir = path.resolve(__dirname, '../markdown/');\n\n\nconsole.log(mdDir);\n\n// articleModel.addOrUpdateArticle('test');\n\nfunction walkMd() {\n  const walker = walk.walk(mdDir, {\n\n  });\n\n  walker.on('file', function(root, fileStats, next) {\n    const { name, birthtime } = fileStats;\n    const fileNamePur = name.replace(/\\.md$/, '');\n    const filePath = path.resolve(mdDir, name);\n\n    fs.readFile(filePath, 'utf8', (err, data) => {\n      const tags = parseTags(data);\n      const desc = parseDesc(data);\n      const img = parseImage(data);\n      const title = parseTitle(data);\n\n      articleModel.insertOrUpdate({\n        title,\n        img,\n        desc,\n        tags,\n        name: fileNamePur,\n        time: birthtime,\n      });\n\n      next();\n\n      console.log(articleModel.getList((item) => {\n        return item.time > 0;\n      }));\n    });\n  });\n}\n\nwalkMd();\n\nconsole.log(articleModel.getList((item) => {\n  return item.time > 0;\n}));\n\nconsole.log('sync article done');\n\n\n\n// WEBPACK FOOTER //\n// ./server/syncArticleData.js","module.exports = require(\"walk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"walk\"\n// module id = 20\n// module chunks = 0 2","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 21\n// module chunks = 0 2","/**\n * 解析md文档中的tag占位符，得到文章的tags\n * @export\n * @param {String} content md内容文本\n * @returns {Array} tags列表\n */\nexport function parseTags (content) {\n  const TAG_REG = /^<!--TAG\\s*(.*)\\s*\\/TAG-->$/m;\n  const matches = content.match(TAG_REG) || [];\n  const tagsStr = matches[1];\n\n  return tagsStr ? tagsStr.split(';') : [];\n};\n\n/**\n * 解析md文档中的描述点位符，得到文章的简介信息\n *\n * @export\n * @param {String} content md内容文本\n * @returns {String} 文章简介\n */\nexport function parseDesc (content) {\n  const DESC_REG = /^<!--DESC\\s*(.*)\\s*\\/DESC-->$/m;\n  const matches = content.match(DESC_REG) || [];\n\n  return matches[1] || '暂无简介信息';\n};\n\n/**\n * 解析文档中的图片信息，得到第一张图片链接\n *\n * @export\n * @param {String} content md内容文本\n * @returns {String} 图片链接\n */\nexport function parseImage (content) {\n  const IMG_REG = /!\\[\\]\\(([^\\(\\)]+)\\)/;\n  const matches = content.match(IMG_REG) || [];\n\n  return matches[1] || 'default_img';\n};\n\n/**\n * 解析文档中的标题信息\n *\n * @export\n * @param {String} content md内容文本\n * @returns {String} 文章标题\n */\nexport function parseTitle (content) {\n  const TITLE_REG = /^#([^#]+)$/m;\n  const matches = content.match(TITLE_REG) || [];\n  const title = matches[1] && matches[1].trim() || '未知标题';\n\n  return title;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/libs/mdParser.js","\nconst BACKPACK_ENTRY_MAP = {\n  server: () => {\n    require('./server');\n  },\n  'sync-article': () => {\n    require('./syncArticleData');\n  }\n};\n\nconst runEntryCommand = () => {\n  console.log(process.env.BACKPACK_ENTRY);\n  const entry = process.env.BACKPACK_ENTRY;\n  const task = BACKPACK_ENTRY_MAP[entry] || BACKPACK_ENTRY_MAP['server'];\n\n  task();\n}\n\nrunEntryCommand();\n\n\n\n// WEBPACK FOOTER //\n// ./server/entry.js"],"sourceRoot":""}