{"version":3,"sources":["webpack:///webpack/bootstrap 67c60c58920012392df1","webpack:///external \"path\"","webpack:///./server/db/index.js","webpack:///external \"fs\"","webpack:///./server/models/index.js","webpack:///./server/db/libs/init.js","webpack:///external \"lowdb\"","webpack:///external \"lowdb/adapters/FileSync\"","webpack:///./server/models/article.js","webpack:///external \"shortid\"","webpack:///./server/syncArticleData.js","webpack:///external \"walk\"","webpack:///./server/libs/mdParser.js"],"names":["low","require","FileSync","path","dbDataPath","resolve","__dirname","adapter","DB","defaults","posts","users","write","articleModel","get","insertOrUpdate","title","time","img","desc","tags","name","data","articleFind","find","value","push","Object","assign","id","shortid","generate","getList","filter","mdDir","walkMd","walker","walk","on","root","fileStats","next","birthtime","fileNamePur","replace","filePath","fs","readFile","err","parseTags","parseDesc","parseImage","parseTitle","console","log","content","TAG_REG","matches","match","tagsStr","split","map","tag","trim","DESC_REG","IMG_REG","TITLE_REG"],"mappings":"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","file":"syncArticle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 23);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 67c60c58920012392df1","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 0\n// module chunks = 0 1 2","import DB from './libs/init';\n\nexport { DB };\n\n\n\n// WEBPACK FOOTER //\n// ./server/db/index.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 2\n// module chunks = 0 1 2","import  * as articleModel from './article';\n\nexport { articleModel };\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/index.js","const low = require('lowdb');\r\nconst FileSync = require('lowdb/adapters/FileSync');\r\nconst path = require('path');\r\nconst dbDataPath = path.resolve(__dirname, '../data.json');\r\nconst adapter = new FileSync(dbDataPath);\r\nconst DB = low(adapter);\r\n\r\n// Set some defaults\r\nDB.defaults({ posts: [], users: [] })\r\n  .write();\r\n\r\nexport default DB;\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/db/libs/init.js","module.exports = require(\"lowdb\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lowdb\"\n// module id = 5\n// module chunks = 0 1 2","module.exports = require(\"lowdb/adapters/FileSync\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lowdb/adapters/FileSync\"\n// module id = 6\n// module chunks = 0 1 2","import { DB } from '../db/index';\nimport shortid from 'shortid';\n\nconst articleModel = DB.get('articles');\n\n// 添加或者更新（如果文章name已经存在的话）一个文章信息\nexport function insertOrUpdate({ title, time, img, desc, tags, name }) {\n  const data = {\n    title,\n    img,\n    desc,\n    tags,\n    name\n  };\n  const articleFind = find({ name });\n\n  if (!articleFind.value()) {\n    // 新增article时，需要传入id和创建时间\n    articleModel.push(Object.assign({}, data, {\n      id: shortid.generate(),\n      time: +time,\n    })).write();\n  } else {\n    articleFind.assign(data).write();\n  }\n};\n\n// 根据条件返回文章列表\nexport function getList (filter = {}) {\n  return articleModel.filter(filter);\n};\n\n// 根据条件返回一个文章信息\nexport function find (filter = {}) {\n  return articleModel.find(filter);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/article.js","module.exports = require(\"shortid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"shortid\"\n// module id = 8\n// module chunks = 0 1 2","import path from 'path';\nimport walk from 'walk';\nimport fs from 'fs';\nimport { articleModel } from './models/index';\nimport { parseTags, parseDesc, parseImage, parseTitle } from './libs/mdParser';\n\nconst mdDir = path.resolve(__dirname, '../markdown/');\n\n// articleModel.addOrUpdateArticle('test');\n\nfunction walkMd() {\n  const walker = walk.walk(mdDir, {\n\n  });\n\n  walker.on('file', function(root, fileStats, next) {\n    const { name, birthtime } = fileStats;\n    const fileNamePur = name.replace(/\\.md$/, '');\n    const filePath = path.resolve(mdDir, name);\n\n    fs.readFile(filePath, 'utf8', (err, data) => {\n      const tags = parseTags(data);\n      const desc = parseDesc(data);\n      const img = parseImage(data);\n      const title = parseTitle(data);\n\n      articleModel.insertOrUpdate({\n        title,\n        img,\n        desc,\n        tags,\n        name: fileNamePur,\n        time: birthtime,\n      });\n\n      next();\n    });\n  });\n}\n\nwalkMd();\n\nconsole.log('sync article done');\n\n\n\n// WEBPACK FOOTER //\n// ./server/syncArticleData.js","module.exports = require(\"walk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"walk\"\n// module id = 24\n// module chunks = 0 2","/**\n * 解析md文档中的tag占位符，得到文章的tags\n * @export\n * @param {String} content md内容文本\n * @returns {Array} tags列表\n */\nexport function parseTags (content) {\n  const TAG_REG = /^<!--TAG\\s*(.*)\\s*\\/TAG-->$/m;\n  const matches = content.match(TAG_REG) || [];\n  const tagsStr = matches[1];\n  let tags = tagsStr ? tagsStr.split(';') : [];\n\n  return tags.map(tag => tag.trim());\n};\n\n/**\n * 解析md文档中的描述点位符，得到文章的简介信息\n *\n * @export\n * @param {String} content md内容文本\n * @returns {String} 文章简介\n */\nexport function parseDesc (content) {\n  //const DESC_REG = /^<!--DESC\\s*(.*)\\s*\\/DESC-->$/m;\n  const DESC_REG = /^(?=[\\u4e00-\\u9fa5]|[\\w])(.*)$/m;\n  const matches = content.match(DESC_REG) || [];\n\n  return matches[1] || '暂无简介信息';\n};\n\n/**\n * 解析文档中的图片信息，得到第一张图片链接\n *\n * @export\n * @param {String} content md内容文本\n * @returns {String} 图片链接\n */\nexport function parseImage (content) {\n  const IMG_REG = /!\\[\\]\\(([^\\(\\)]+)\\)/;\n  const matches = content.match(IMG_REG) || [];\n\n  return matches[1] || '/image/default-article-img.jpg';\n};\n\n/**\n * 解析文档中的标题信息\n *\n * @export\n * @param {String} content md内容文本\n * @returns {String} 文章标题\n */\nexport function parseTitle (content) {\n  const TITLE_REG = /^#(.+)$/m;\n  const matches = content.match(TITLE_REG) || [];\n  const title = matches[1] && matches[1].trim() || '未知标题';\n\n  console.log('title: ' + title);\n  return title;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/libs/mdParser.js"],"sourceRoot":""}